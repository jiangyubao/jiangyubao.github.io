<!DOCTYPE html>
<html ng-app="myApp">
<head>
    <meta charset="utf-8">
    <title>Screen</title>
    <link href="http://apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap-theme.min.css"
          rel="stylesheet"/>
    <link href="http://apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css"
          rel="stylesheet"/>
    <script src="http://apps.bdimg.com/libs/angular.js/1.3.9/angular.min.js"></script>
    <style>
        form .ng-invalid.ng-dirty {
            background-color: lightpink;
        }

        form .ng-valid.ng-dirty {
            background-color: lightgreen;
        }
    </style>
    <script type="application/javascript">
        angular.module('myApp', []).controller('MyCtrl',
                function ($scope) {
                    $scope.intPattern = /^[0-9]{1,3}$/;
                    $scope.model = {};
                    $scope.model.points = [];
                    $scope.model.results = [];
                    for (var i = 0; i < 10; i++) {
                        $scope.model.points.push({x: i, y: i});
                        $scope.model.results.push({bx: 0, by: 0, x: 0, y: 0});
                    }
                    $scope.cal = function (index) {
                        $scope.model.results[index].bx = parseInt($scope.model.points[index].x / 40);
                        $scope.model.results[index].by = parseInt($scope.model.points[index].y / 30);
                        $scope.model.results[index].x = Math.round(128 * ($scope.model.points[index].x % 40) / 40.64);
                        $scope.model.results[index].y = Math.round(128 * ($scope.model.points[index].y % 30) / 30.48);
                    }
                    for (var i = 0; i < 10; i++) {
                        $scope.cal(i);
                    }
                }).filter("hex", function () {
                    return function (v) {
                        var vv = v.toString(16);
                        return vv.length == 1?'0'+vv:vv;
                    };
                });
    </script>
</head>
<body ng-controller="MyCtrl">
<form novalidate name="tableForm">
    <table class="table table-striped table-bordered table-hover table-condensed">
        <thead>
        <tr>
            <th>X坐标(单位：毫米)</th>
            <th>Y坐标(单位：毫米)</th>
            <th>串口数据(Y,X)</th>
        </tr>
        </thead>
        <tbody ng-form name="ppdForm" ng-repeat="point in model.points">
        <tr>
            <td><input type="text" class="form-control" name="x" required ng-pattern="intPattern" ng-model="point.x"
                       ng-change="cal($index)"></td>
            <td><input type="text" class="form-control" name="y" required ng-pattern="intPattern" ng-model="point.y"
                       ng-change="cal($index)"></td>
            <td>
                {{model.results[$index].by|hex}}{{model.results[$index].y|hex}},{{model.results[$index].bx|hex}}{{model.results[$index].x|hex}}
            </td>
        </tr>
        </tbody>
    </table>
</form>
<div class="panel panel-info">
    <div class="panel-heading">
        <h3 class="panel-title">备注说明</h3>
    </div>
    <div class="panel-body">
        <ol>
            <li>
                坐标参数：Y轴走向：从上到下；X轴走向：从左到右；开始位置：左上。
            </li>
            <li>
                数据格式：5个字节，分别是：动作值(0x81按下，0x80抬起)；Y区值(0x00-0x05)；Y区内值(0x00-0x7F)；X区值(0x00-0x05)；X区内值(0x00-0x7F)。
            </li>

            <li>
                屏幕参数：分辨率：1024x768；长宽比率：4:3；12寸；理论屏幕大小是：240mmx180mm，实际屏幕大小是：243.84mmx182.88mm；分6x6区，每区分128x128区内值。
            </li>
            <li>
                测量工具：<a href="screen.pdf">标准二维毫米尺 </a>，不干胶打印，A4。
            </li>
        </ol>
    </div>
</div>
</body>
</html>
